---

# - name: get facts from the swarm workers
#   setup:
#   - debug: var=allfacts
- debug: var=hostvars['docker-swarm-manager']
- debug: var=hostvars['localhost']
- debug: var=hostvars['docker-swarm-node1']

- name: Init the Docker Swarm Nodes
  docker_swarm:
    state: join
    tls: yes
    # advertise_addr: 
      # should be detected automatically
    join_token: "{{ hostvars['docker-swarm-manager']['JoinTokens']['Worker'] }}"
    remote_addrs: 
      - "{{ hostvars['localhost']['gce_manager_ip']['address'] }}:2377"
